## 第七章 网络编程  

> Node 是一个面向网络而生的平台，它具有事件驱动、无阻塞、单线程等特性，具备良好的可伸缩性，使得它十分轻量，适合在分布式网络中扮演各种各样的角色。  

## 7.1 构建 TCP 服务  

* OSI模型由七层组成：物理层、数据链结层、网络层、传输层、会话层、表示层、应用层。  

* OSI 七层协议示意：  

        HTTP / SMTP / IMAP 等   ：  应用层  
        加密 / 解密 等           ：  表示层  
        通信连接 / 维持会话      ：  会话层  
        TCP / UDP               ：  传输层  
        IP                      ：  网络层  
        网络特有的链路接口        ：  链路层  
        网络物理硬件             ：  物理层  

* TCP 全名传输控制协议，在 OSI 模型中属于传输层协议。  

* TCP 是面向连接的协议，其显著的特征是在传输之前需要 3 次握手形成会话。  

* 只有在会话形成之后，服务器端和客户端之间才能互相发送数据。  

* TCP 针对网络中的小数据包有一定的优化策略：Nagle 算法。  

* Nagle 算法要求缓冲区的数据达到一定数量或者一定时间后才将其发出，所以小数据包会被 Nagel 算法合并，以此来优化网络。  

* Nagle 算法优化虽然使网络带宽呗有效地使用，但是数据有可能被延迟发送。  

* 在 Node 中，由于 TCP 默认开启了 Nagle 算法，可以调用 socket.setNoDelay(true) 去掉 Nagle 算法。  

* UDP 又称用户数据包协议，与 TCP 一样同属网络传输层。  

* UDP 与 TCP 最大的不同是 UDP 不是面向连接的。  

* UDP 提供面向事务的简单不可靠信息传输服务，无需连接，资源消耗低，处理快速且灵活。  

* UDP 常应用在那种偶尔丢一两个数据包也不会产生重大影响的场景，比如音频、视频等。  

