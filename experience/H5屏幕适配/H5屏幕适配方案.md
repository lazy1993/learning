# H5 屏幕适配方案

> 受限于本人的知识限制，虽然已经很仔细的进行了求证，但是仍免不了有疏漏，如果有发现错误的地方欢迎联系：2280042554@qq.com。  

## 基础概念

* 响应式布局和自适应  
    * 自适应是一套模板适应所有终端，但每种设备上看到的主体版式是一样的。  
    * 响应式一套模板适应所有终端，但每种设备看到的版式可以是不一样的。可以根据屏幕的大小自动的调整页面的展现方式，以及布局。（比自适应布局范围更广泛）  

> [响应式布局和自适应布局的不同](https://www.cnblogs.com/yuanziwen/p/6926561.html)  

* 像素（pixel）  
    * 设备像素：设备屏幕的物理像素。  
    * CSS像素：为Web开发者创造的，在CSS和JS中使用的一个抽象层。  
    * CSS像素和设备像素的比例取决于屏幕是否高DPI和用户缩放的比例。  

* 缩放  
    * 桌面浏览器的缩放仅改变内容尺寸，不改变布局视口；移动端缩放则整体改变。  
    * 浏览器可以关闭禁止缩放功能。  

* 分辨率  
    * 物理分辨率：设备每英寸内点数（DPI）。  
    * 设备像素比：设备像素个数和理想视口的比（DPR）。  
    * dppx和dpi：每一个像素的点数。JS中的window.devicePixelRatio和媒体查询的device-pixel-ratio的单位。  

* 视口(viewport)：代表当前可见的计算机图形区域。  
    * 在桌面端，指的是浏览器的可视区域；  
    * 移动端涉及到三个视口：分别是 Layout Viewport（布局视口）、 Visual Viewport（视觉视口）、Ideal Viewport（理想视口）。当使用触屏双指缩放，当动态键盘在手机上弹出的时候，或者之前隐藏的地址栏变得可见的时候，visual viewport 缩小了，但是 layout viewport 却保持不变。  
    * 视口单位中的“视口”，在桌面端，毫无疑问指的就是浏览器的可视区域；但是在移动端，它指的则是三个 Viewport 中的 Layout Viewport 。  
    * 视口单位区别于%单位，视口单位是依赖于视口的尺寸，根据视口尺寸的百分比来定义的；而%单位则是依赖于元素的祖先元素。  

* CSS 中的一些相对单位：百分比（%）、视口单位（vh,vw,vmin,vmax）、字体单位（em,rem）（这些就是自适应解决方案的思路来源）  

## 移动端常见的布局方式

* 固定布局（固定宽度）  
* 流动布局(百分比)  
* 浮动布局（float）  
* flexbox 布局（flex）  
* 定位布局（position）  

> 参考：[前端之移动端开发技巧](https://zhuanlan.zhihu.com/p/34854971)  

## 适配布局的几种方式

>  参考：[从网易与淘宝的font-size思考前端设计稿与工作流](http://www.cnblogs.com/lyzg/p/4877277.html)  

基本适配规则：文字流式，控件弹性，图片等比缩放。  

下面是几种常见的自适应布局。  

### 使用媒体查询进行适配布局

使用媒体查询进行适配布局的思路是：选取主流设备宽度尺寸作为断点针对性写额外的样式进行适配，有时还会针对几款具体设备做完美适配。  

* 这种方案的优点是：  
    * 在断点设备尺寸上的展示完美  
    * 对 js 无依赖  
    * 简单  

* 这种方案的缺点是：  
    * 布局突变： 布局在响应断点范围内的分辨率下维持不变，而在响应断点切换的瞬间，布局带来断层式的切换变化。（对于移动端来说这个问题不大）  
    * 需要写多套样式，工作量大。  
    * 只能在部分屏幕尺寸完美展示。  
    * 1px 需要用别的办法进行处理  

* 推荐实践方案：  
    * 使用 bootstrap 等成熟的框架  

### 通过 rem 单位进行适配布局

通过 rem 单位进行适配布局的思路是：根据设备的宽度尺寸设置 rem 的大小，在需要设置大小的场合使用 rem 代替 px 。  

* 这种方案的优点是：  
    * 配置好配套插件后使用简单  
    * 在各种尺寸下均能表现的很好  
    * 配合设置 data-dpr 能够很方便的在 iOS 下实现 1px  
    * 对 css 代码侵入少  

* 缺点：  
    * 脚本依赖：需要在头部内嵌一段脚本来进行监听分辨率的变化来动态改变根元素字体大小，使得 CSS 与 JS 耦合了在一起。  

* 推荐实践方案：  
    * 使用 淘宝弹性布局方案lib-flexible  
        * js 建议内联处理，且尽可能早的引入这个js文件，避免出现没有设置 dpr 导致页面布局错乱  
        * 搭配使用 px2rem 插件  
        * 注意，该方案实际上放弃了在安卓机型上的 '1px' 解决  

### 利用视口单位进行适配布局

利用视口单位进行适配布局的思路是：视口单位天然只和视口有关，在需要设置大小的场合使用 vw 代替 px 。  

* 这种方案的优点是：  
    * 不同机型的适配更好  
    * 能够实现真正的流体排版  

* 这种方案的缺点是：  
    * 无法精确地控制放大比率。  
    * 没有最大或最小字体大小。（配合媒体查询）  
    * 和使用font-size相比，更容易使用像素来声明大小。  
    * 写法麻烦  
    * 兼容性有问题（最致命）  

* 使用方法一：仅使用 vw 和 vh  
    * 使用 vw 设置页面元素大小  

* 使用方法二：搭配vw和rem  
    * 使用 vw 设置 rem 的大小  
    * 限制 rem 的最大和最小值  
    * 使用 rem 设置页面元素的大小  

> 参考：[利用视口单位实现适配布局](https://aotu.io/notes/2017/04/28/2017-4-28-CSS-viewport-units/)  

* 推荐实践方案：  
    * 暂无，下面是大神给出的实践方案。  
> 参考：[如何在Vue项目中使用vw实现移动端适配](https://www.w3cplus.com/mobile/vw-layout-in-vue.html)  
> 参考：[如何在Vue项目中使用vw实现移动端适配(转)](https://www.jianshu.com/p/1f1b23f8348f)（上面那个现在无法打开）  


## 总结

上面几种方案都有各自的局限，我们应该根据自己项目的实际情况做取舍。下面是我的一点建议：  
* 如果要求同时应用在电脑和手机上，而且对于设计稿的还原没有很高的要求，或者页面内容主要是文本等，可以使用响应式布局。  

* 如果只是针对移动端的页面适配，且安卓机的 1px 可以允许不解决，建议使用 rem 方案。  
* 如果对适配的要求特别高，且对低端机可以不做支持，使用视口单位方案。  

> [使用Flexible实现手淘H5页面的终端适配](https://github.com/amfe/article/issues/17)  
> [rem, vw, 还是...? 各凭本事的移动端适配方案](https://segmentfault.com/a/1190000016678799)  
